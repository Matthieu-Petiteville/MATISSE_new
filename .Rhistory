getwd()
getwd()
source("/Common/init.r")
load("/Common/init.r")
load("//Common/init.r")
getwd()
source"common/init.r"
source "common/init.r"
source("common/init.r")
source("common/init.r")
getenv("MATISSE_HOME")
Sys.getenv("MATISSE_HOME")
Sys.getenv("R_HOME")
getwd()
Sys.getenv("MATISSE_HOME")
setwd(Sys.getenv("MATISSE_HOME"))
M_home <- gsub("\\\\","/",Sys.getenv("MATISSE_HOME"))
M_data <- gsub("\\\\","/",Sys.getenv("MATISSE_DATA"))
setwd(Sys.getenv("MATISSE_HOME"))
M_home
Sys.getenv("MATISSE_HOME")
M_home
file_name_from <- paste("D:/Stage_Petiteville/Projet_Ademe/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/","Optimiste","/","ssrec","/IMACLIM_3ME.xlsx",sep="")
horizon_v <- c(2025,2030,2035)
scenario_v <- c("AMS","AME","ssRES","ssTCO","ssVE")
scenario_classement_v <- c("Median","Optimiste","Pessimiste","Optimal_co2","Optimal_ener","Poor","Rich")
redistribution_v <- c("decile","forfait","niveau_vie","ssrec","tuu")
Iteration_v <- 0:10
mandatory_data_files <- c(
"/IMACLIM/Sorties Three-ME.xlsx",
"/IMACLIM/Output_macro_code_iter_0_ssrec.xlsx",
"/IMACLIM/Output_macro_code_iter_0.xlsx",
"/IMACLIM/EMS.xlsx",
"/IMACLIM/coeff_dep_ems.csv",
"/Data/Econometrie_demande/elasticite_demande_finale.xlsx",
"/Data/BDF_2010/menage.csv",
"/Data/BDF_2010/depmen.csv",
"/Data/BDFE_delauretis/menage_calibr_2010.RData",
"/Data/PHEBUS/Clode_dpe_energie_decideur_revenu.csv",
"/Data/BDF_2010/menage.xlsx",
"/Data/BDF_2010/individu.xlsx",
"/Data/BDF_2010/c05.csv",
"/Data/Econometrie_demande/datacp_typovuln_bdf_2011.xlsx",
"/Data/BDFE_delauretis/appmen_depensesactiv_2010.RData",
"/Data/BDF_2010/AUTOMOBILE.xlsx",
"/Data/Nomenclature_CIRED_ADEME/Definition_revenus.xlsx",
"/Data/Nomenclature_CIRED_ADEME/Nomenclature_coicop_threeme.xlsx",
"/Data/Data_interne/list_source_usage.RData",
"/Data/BDFE_delauretis/Prix_energie_par_classe.csv",
"/Data/BDFE_delauretis/appmen_intensites_2010.RData",
"/Data/Econometrie_demande/elasticite_demande.RData",
"/Data/Data_interne/coeff_ems_2010.RData",
"/Data/ThreeME/Ventes_VP.xlsx",
"/Donnees_brutes/INSEE/INSEE - projection men.xlsx",
"/Donnees_brutes/INSEE/INSEE - projection pop.xlsx",
"/Donnees_brutes/INSEE/pop_INSEE.RData"
)
Check_missing_files <- function(){
#Does a full check on mandatory files to run MATISSE
for(mandatory_data_file in mandatory_data_files){
if(!file.exists(paste(M_data,mandatory_data_file,sep=""))){cat("Missing file ",M_data,mandatory_data_file,"\n",sep=" ")}
}
for(scenario in scenario_v){
for(horizon in horizon_v){
file_name <- paste(M_data,"/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/","Optimiste","/","ssrec","/IMACLIM_3ME.xlsx",sep="")
if(!file.exists(file_name)){cat("Missing file ",file_name,"\n",sep=" ")}
}
}
}
Initialize_output_folders <- function(){
#Create all folders and path for MATISSE set up and checks
source(paste(M_home,"/Common/default_values.r",sep=""))
source(paste(M_home,"/Common/tools.r",sep=""))
CreateFolder(paste(M_data,"/Output",sep=""))
CreateFolder(paste(M_data,"/Output/Step_0",sep=""))
CreateFolder(paste(M_data,"/Output/Projet_Ademe",sep=""))
for(horizon in horizon_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,sep=""))
for(scenario in scenario_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,sep=""))
for(scenario_classement in scenario_classement_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,"/",scenario_classement,sep=""))
for(redistribution in redistribution_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,"/",scenario_classement,"/",redistribution,sep=""))
for(Iteration in Iteration_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,"/",scenario_classement,"/Iteration_",Iteration,sep=""))
}
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,"/",scenario_classement,"/Technical_change",sep=""))
}
}
}
}
}
Check_missing_files <- function(){
#Does a full check on mandatory files to run MATISSE
for(mandatory_data_file in mandatory_data_files){
if(!file.exists(paste(M_data,mandatory_data_file,sep=""))){cat("Missing file ",M_data,mandatory_data_file,"\n",sep=" ")}
}
for(scenario in scenario_v){
for(horizon in horizon_v){
file_name <- paste(M_data,"/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/","Optimiste","/","ssrec","/IMACLIM_3ME.xlsx",sep="")
if(!file.exists(file_name)){cat("Missing file ",file_name,"\n",sep=" ")}
}
}
}
CopyImaclimFiles <- function(){
for(scenario in scenario_v){
for(horizon in horizon_v){
file_name_from <- paste("D:/Stage_Petiteville/Projet_Ademe/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/","Optimiste","/","ssrec","/IMACLIM_3ME.xlsx",sep="")
file_name_to <- paste(M_data,"/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/","Optimiste","/","ssrec","/IMACLIM_3ME.xlsx",sep="")
}
}
}
Check_missing_files()
file_name_from <- paste("D:/Stage_Petiteville/Projet_Ademe/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/","Optimiste","/","ssrec","/IMACLIM_3ME.xlsx",sep="")
for(scenario in scenario_v){
for(horizon in horizon_v){
file_name_from <- paste("D:/Stage_Petiteville/Projet_Ademe/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/","Optimiste","/","ssrec","/IMACLIM_3ME.xlsx",sep="")
file_name_to <- paste(M_data,"/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/","Optimiste","/","ssrec","/IMACLIM_3ME.xlsx",sep="")
}
}
file_name_from
CopyImaclimFiles <- function(){
for(scenario in scenario_v){
for(horizon in horizon_v){
file_name_from <- paste("D:/Stage_Petiteville/Projet_Ademe/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/","Optimiste","/","ssrec","/IMACLIM_3ME.xlsx",sep="")
file_name_to <- paste(M_data,"/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/","Optimiste","/","ssrec","/IMACLIM_3ME.xlsx",sep="")
file.copy(file_name_from,file_name_to)
}
}
}
CopyImaclimFiles()
warnings()
Initialize_output_folders <- function(){
#Create all folders and path for MATISSE set up and checks
source(paste(M_home,"/Common/default_values.r",sep=""))
source(paste(M_home,"/Common/tools.r",sep=""))
CreateFolder(paste(M_data,"/Output",sep=""))
CreateFolder(paste(M_data,"/Output/Step_0",sep=""))
CreateFolder(paste(M_data,"/Output/Projet_Ademe",sep=""))
CreateFolder(paste(M_data,"/Output/Projet_Ademe/Results",sep=""))
for(horizon in horizon_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,sep=""))
for(scenario in scenario_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,sep=""))
for(scenario_classement in scenario_classement_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,"/",scenario_classement,sep=""))
for(redistribution in redistribution_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,"/",scenario_classement,"/",redistribution,sep=""))
for(Iteration in Iteration_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,"/",scenario_classement,"/Iteration_",Iteration,sep=""))
CreateFolder(paste(M_data,"/Output/Projet_Ademe/Results",scenario,"/",horizon,"/",scenario_classement,"/Iteration_",Iteration,sep=""))
}
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,"/",scenario_classement,"/Technical_change",sep=""))
}
}
}
}
}
Initialize_output_folders()
warnings()
#Basic function starting the chrono for benchmark of solutions
ChrStart <- function(){
chrono_timest <<- Sys.time()
}
#Basic function printing the chrono for benchmark of solutions
ChrPrint <- function(){
print(Sys.time()-chrono_timest)
}
#Basic function stopping the chrono and removing the variable for benchmark of solutions
ChrEnd <- function(){
print(Sys.time()-chrono_timest)
glob_var <- ls(pos = ".GlobalEnv")
rm(list = glob_var[grep("chrono_timest", glob_var)] , pos=".GlobalEnv")
}
#Similar to dplyr mutate
mutate_when <- function(data, ...) {
dots <- eval(substitute(alist(...)))
for (i in seq(1, length(dots), by = 2)) {
condition <- eval(dots[[i]], envir = data)
mutations <- eval(dots[[i + 1]], envir = data[condition, , drop = FALSE])
data[condition, names(mutations)] <- mutations
}
data
}
# Source ------------------------------------------------------------------
# https://stackoverflow.com/questions/34096162/dplyr-mutate-replace-on-a-subset-of-rows
#Create folder if it doesn't exist, no warning
CreateFolder <- function(folder_name){
if(!dir.exists(folder_name)){dir.create(folder_name)}
}
Initialize_output_folders <- function(){
#Create all folders and path for MATISSE set up and checks
source(paste(M_home,"/Common/default_values.r",sep=""))
source(paste(M_home,"/Common/tools.r",sep=""))
CreateFolder(paste(M_data,"/Output",sep=""))
CreateFolder(paste(M_data,"/Output/Step_0",sep=""))
CreateFolder(paste(M_data,"/Output/Projet_Ademe",sep=""))
for(horizon in horizon_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,sep=""))
for(scenario in scenario_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,sep=""))
for(scenario_classement in scenario_classement_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,"/",scenario_classement,sep=""))
for(redistribution in redistribution_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,"/",scenario_classement,"/",redistribution,sep=""))
for(Iteration in Iteration_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,"/",scenario_classement,"/Iteration_",Iteration,sep=""))
}
CreateFolder(paste(M_data,"/Output/Projet_Ademe/",horizon,"/",scenario,"/",scenario_classement,"/Technical_change",sep=""))
}
}
}
}
CreateFolder(paste(M_data,"/Output/Projet_Ademe/Results",sep=""))
for(scenario in scenario_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/Results/",scenario,sep=""))
for(horizon in horizon_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/Results/",scenario,"/",horizon,sep=""))
for(scenario_classement in scenario_classement_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/",scenario_classement,sep=""))
for(redistribution in redistribution_v){
CreateFolder(paste(M_data,"/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/",scenario_classement,"/",redistribution,sep=""))
}
}
}
}
}
Initialize_output_folders()
Check_missing_files <- function(){
#Does a full check on mandatory files to run MATISSE
for(mandatory_data_file in mandatory_data_files){
if(!file.exists(paste(M_data,mandatory_data_file,sep=""))){cat("Missing file ",M_data,mandatory_data_file,"\n",sep=" ")}
}
for(scenario in scenario_v){
for(horizon in horizon_v){
file_name <- paste(M_data,"/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/","Optimiste","/","ssrec","/IMACLIM_3ME.xlsx",sep="")
if(!file.exists(file_name)){cat("Missing file ",file_name,"\n",sep=" ")}
}
}
}
Check_missing_files()
CopyImaclimFiles <- function(){
for(scenario in scenario_v){
for(horizon in horizon_v){
file_name_from <- paste("D:/Stage_Petiteville/Projet_Ademe/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/","Optimiste","/","ssrec","/IMACLIM_3ME.xlsx",sep="")
file_name_to <- paste(M_data,"/Output/Projet_Ademe/Results/",scenario,"/",horizon,"/","Optimiste","/","ssrec","/IMACLIM_3ME.xlsx",sep="")
file.copy(file_name_from,file_name_to)
}
}
}
CopyImaclimFiles()
